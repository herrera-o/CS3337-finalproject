{% extends "base.html" %}
{% load static %}

{% block sidenav %}
   {% for item in item_list %}
      <li>
        <a href="{{ item.link }}">  {{ item.item }} </a>
      </li>
   {% endfor %}
{% endblock sidenav %}

{% block content %}
   <h1>Book Detail</h1>
   <table border="2" >
      <tr>
          <th>
              Book Picture
          </th>
          <th>
              Book Name
          </th>
          <th>
              Book Price
          </th>
          <th>
              User Name
          </th>
          <th>
              Book Post Date
          </th>
          <th>
              Book Web
          </th>
      </tr>
       <tr>
           <td>
           <img src="{% static book.pic_path %}" width="100" />
         </td>
         <td>
            {{ book.name }}
         </td>
         <td>
            {{ book.price }}
         </td>
          <td>
            {{ book.username }}
         </td>
           <td>
            {{ book.publishdate }}
         </td>
           <td>
               {{ book.web }}
           </td>
      </tr>
   </table>

{% if user.is_authenticated %}
  <a href="{% url 'rate_book' book.id 'true' %}">üëç</a>
  <a href="{% url 'rate_book' book.id 'false' %}">üëé</a>
{% endif %}

{% if total_ratings > 0 %}
    <p>{{ positive_ratings }} of {{ total_ratings }} users liked this book ({{ percentage|floatformat:0 }}%)</p>
{% else %}
    <p>No ratings yet.</p>
{% endif %}

<!--Comment section-->
<h3>Comments</h3>
{% for comment in comments %}
    <p><strong>{{ comment.user.username }}</strong> ({{ comment.created_at|date:"M d, Y" }}):</p>
    <p>{{ comment.text }}</p>
{% empty %}
    <p>No comments yet.</p>
{% endfor %}

<!--Checkif user is logged in. if true show comment form-->
{% if user.is_authenticated %}
    <h4>Add a Comment</h4>
    <form method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Post Comment</button>
    </form>
{% else %}
    <p>You must be logged in to add a comment.</p>
    <p> <a href="{% url 'login' %}">Log in</a></p>
{% endif %}
{% endblock content %}
